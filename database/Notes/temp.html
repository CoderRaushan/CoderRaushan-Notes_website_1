<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SGPA Calculator</title>
    <link rel="icon" href="/photos/rausnotes39_logo.png">
    <!-- jquery code for imporing footer -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <!-- code for nav items to move towards left side -->
    <script src="/header&footer/nav.js"></script>
    <script>
        // Add this script to handle user authentication status
        document.addEventListener("DOMContentLoaded", function () {
            const authStatus = localStorage.getItem("user");
            if (authStatus) {
                // User is signed in
                document.getElementById("signupBtn").style.display = "none";
                document.getElementById("signinBtn").style.display = "none";
                document.getElementById("signout").style.display = "inline-block";
                document.getElementById("user_icon").style.display = "none";
                document.getElementById("it_user_iamge").src = JSON.parse(localStorage.getItem("user")).photoURL;
                document.getElementById("user_img").src = JSON.parse(localStorage.getItem("user")).photoURL;
                document.getElementById("bottom_menu_profile").textContent = JSON.parse(localStorage.getItem("user")).displayName.split(' ')[0];
            }
            else {
                // User is not signed in
                document.getElementById("signupBtn").style.display = "inline-block";
                document.getElementById("signinBtn").style.display = "inline-block";
                document.getElementById("signout").style.display = "none";
                document.getElementById("it_user_iamge").style.display = "none";
                document.getElementById("kaho").style.display = "none";
                document.getElementById("kaho").style.display = "user_img";

                document.getElementById("bottom_menu_profile").style.display = "none";
                setTimeout(function () {
                    window.location.href = "/database/login.html";
                }, 1000);
            }
        });

    </script>
    <style>
        * {
            padding: 0;
            margin: 0;
            box-sizing: border-box;
        }
        

        .main
        {
            height: 100vh;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
    </style>
</head>
<body>
    <!-- nav file included -->
    <!-- <div id="includnav"></div> -->
    <nav class="nav-class-for-phone">
        <input type="checkbox" id="check">
        <label for="check" class="checkbtn"><i class="fa-solid fa-bars"></i></label>
        <label class="logo"><img style="cursor: pointer;" class="lp" id="myImage" src="/photos/rausnotes39_logo.png"
                alt="logo">RausNotes39</label>
        <ul class="nav-item">
            <li><a class="active" href="index.html" target="_blank">Home</a></li>
            <li><a class="active" id="about_dev_btn">About</a>
            </li>
            <li><a class="active">Service</a></li>
            <li><a class="active" id="feedback_btn">Feedback</a></li>
            <li><a id="signinBtn" href="/database/login.html">Login</a></li>
            <li><a id="kaho" href="/userProfile/userProfile.html"><img src="" alt="user_img" id="user_img"
                        class="user_img_css"></a></li>
            <li><a class=" signuphidekarnahai" id="signupBtn" href="/database/login.html">SignUp</a></li>
            <li><a id="signout" class="logoutbtn">LogOut</a></li>
            <li><i onclick="sharepage()" class="fa-solid fa-share-from-square"></i></li>
            <li id="darkicon"><i class="fa-solid fa-moon"></i></li>
        </ul>
    </nav>
    <!-- top nav items  -->
    <div class="main_nav_nested_item_ele">
        <!-- <a href="portfolio/portfolio.html">
        <div class="dropdown">
            <button class="dropbtn">Portfolio</button>
        </div>
    </a> -->
        <a href="/ppt_section/ppt_page.html">
            <div class="dropdown">
                <button class="dropbtn">PPT</button>
            </div>
        </a>
        <div class="dropdown">
            <button class="dropbtn"> Notes <i class="fa-solid fa-caret-down dropdown-arrow"></i></button>
            <div class="dropdown-content">
                <a id="applied_arrow">Applied Science <i class="fa-solid fa-caret-right applied-arrowi"></i>
                    <div class="dropdown-content_for_applied">
                        <a href="/notes/physics_Group.html">Physics</a>
                        <a href="notes/chemistry_Group.html">Chemistry</a>
                    </div>
                </a>
                <a id="it_arrow">IT <i class="fa-solid fa-caret-right it-arrowi"></i>
                    <div class="dropdown-content_for_it">
                        <a href="/notes/it_3rd_sem_pdfs.html">Semester 3</a>
                        <a href="/notes/it_4rd_sem_pdfs.html">Semester 4</a>
                    </div>
                </a>
                <a id="cse_arrow">CSE <i class="fa-solid fa-caret-right cse-arrowi"></i>
                    <div class="dropdown-content_for_cse">
                        <a href="/notes/cse_3rd_pdfs.html">Semester 3</a>
                        <a href="/sgpa/sgpa_sem4/cse_sem4_sgpa.html">Semester 4</a>
                    </div>
                </a>
            </div>
        </div>
        <div class="dropdown">
            <button class="dropbtn">SGPA <i class="fa-solid fa-caret-down dropdown-arrow"></i></button>
            <div class="dropdown-content_for_sgpa">
                <a id="it-arrow_sgpa">IT <i class="fa-solid fa-caret-right it-arrowi_sgpa"></i>
                    <div class="dropdown-content_for_it_sgpa">
                        <a id="it-arrow_sgpa_leet">Semester 3
                            <i class="fa-solid fa-caret-right it-arrowi_sgpa_leet"></i>
                            <div class="dropdown-content_for_it_leet">
                                <a href="/sgpa/it_3_sgpa.html">Regular</a>
                                <a href="/sgpa/it_3_sgpa_for_leet.html">Leet</a>
                            </div>
                        </a>
                        <a href="/sgpa/sgpa_sem4/it_sem4_sgpa.html">Semester 4</a>
                    </div>
                </a>
                <a id="cse-arrow_sgpa">CSE <i class="fa-solid fa-caret-right cse-arrowi_sgpa"></i>
                    <div class="dropdown-content_for_cse_sgpa">
                        <a id="cse-arrow_sgpa_leet">Semester 3
                            <i class="fa-solid fa-caret-right cse-arrowi_sgpa_leet"></i>
                            <div class="dropdown-content_for_cse_leet">
                                <a href="/sgpa/cse_3_sgpa.html">Regular</a>
                                <a href="/sgpa/cse_3_sgpa_for_leet.html">Leet</a>
                            </div>
                        </a>
                        <a href="/sgpa/sgpa_sem4/cse_sem4_sgpa.html">Semester 4</a>
                    </div>
                </a>
                <a id="ece-arrow_sgpa">ECE <i class="fa-solid fa-caret-right ece-arrowi_sgpa"></i>
                    <div class="dropdown-content_for_ece_sgpa">
                        <a id="ece-arrow_sgpa_leet">Semester 3
                            <i class="fa-solid fa-caret-right ece-arrowi_sgpa_leet"></i>
                            <div class="dropdown-content_for_ece_leet">
                                <a href="/sgpa/ece_3_sgpa.html">Regular</a>
                                <a href="/sgpa/ece_3_sgpa_for_leet.html">Leet</a>
                            </div>
                        </a>
                        <a href="#">Semester 4</a>
                    </div>
                </a>
                <a id="ee-arrow_sgpa">EE <i class="fa-solid fa-caret-right ee-arrowi_sgpa"></i>
                    <div class="dropdown-content_for_ee_sgpa">
                        <a id="ee-arrow_sgpa_leet">Semester 3
                            <i class="fa-solid fa-caret-right ee-arrowi_sgpa_leet"></i>
                            <div class="dropdown-content_for_ee_leet">
                                <a href="/sgpa/ee_3_sgpa.html">Regular</a>
                                <a href="/sgpa/ee_3_sgpa_for_leet.html">Leet</a>
                            </div>
                        </a>
                        <a href="#">Semester 4</a>
                    </div>
                </a>
                <a id="ce-arrow_sgpa">CE <i class="fa-solid fa-caret-right ce-arrowi_sgpa"></i>
                    <div class="dropdown-content_for_ce_sgpa">
                        <a id="ce-arrow_sgpa_leet">Semester 3
                            <i class="fa-solid fa-caret-right ce-arrowi_sgpa_leet"></i>
                            <div class="dropdown-content_for_ce_leet">
                                <a href="/sgpa/ce_3_sgpa.html">Regular</a>
                                <a href="/sgpa/ce_3_sgpa_for_leet.html">Leet</a>
                            </div>
                        </a>
                        <a href="#">Semester 4</a>
                    </div>
                </a>
                <a id="me-arrow_sgpa">ME <i class="fa-solid fa-caret-right me-arrowi_sgpa"></i>
                    <div class="dropdown-content_for_me_sgpa">
                        <a id="me-arrow_sgpa_leet">Semester 3
                            <i class="fa-solid fa-caret-right me-arrowi_sgpa_leet"></i>
                            <div class="dropdown-content_for_me_leet">
                                <a href="/sgpa/me_3_sgpa.html">Regular</a>
                                <a href="/sgpa/me_3_sgpa_for_leet.html">Leet</a>
                            </div>
                        </a>
                        <a href="#">Semester 4</a>
                    </div>
                </a>
            </div>
        </div>
        <div class="dropdown">
            <button class="dropbtn">Game <i class="fa-solid fa-caret-down dropdown-arrow"></i></button>
            <div class="dropdown-content_for_game">
                <a href="/game/color_genetator.html">Color Gen</a>
                <a href="/game/gues_a_number.html">Guess no</a>
                <a href="/game/no_to_wa_link_generator.html">WaLinkGen</a>
                <a href="#">Game4</a>
                <a href="#">Game5</a>
                <a href="#">Game6</a>
            </div>
        </div>
        <!-- <a href="/weather/weather.html">
        <div class="dropdown">
            <button class="dropbtn">Weather</i></button>
        </div>
    </a> -->
    </div>
    <div class="main">
        

        
        <!-- bottom menu -->
        <div class="bottom_menu">
            <a class="bottom_menu_anchor" href="/index.html">
                <div class="bottom_menubox1 hover_on_pro">
                    <i class="fa-solid fa-house"></i>
                    <h4>Home</h4>
                </div>
            </a>
            <a class="bottom_menu_anchor" href="/notes/notes_section.html">
                <div class="bottom_menubox1 hover_on_pro">
                    <i class="fa-solid fa-notes-medical"></i>
                    <h4>Notes</h4>
                </div>
            </a>
            <a class="bottom_menu_anchor" href="/sgpa/sgpa.html">
                <div class="bottom_menubox1 hover_on_pro">
                    <i class="fa-solid fa-calculator"></i>
                    <h4>SgpaC</h4>
                </div>
            </a>
            <a class="bottom_menu_anchor" href="../../userProfile/userProfile.html">
                <div class="bottom_menubox1" id="user_profile_btn">
                    <i class="fa-solid fa-user" id="user_icon"></i>
                    <img src="" alt="uesr image" id="it_user_iamge">
                    <h4 id="bottom_menu_profile">Profile</h4>
                </div>
            </a>
        </div>
    </div>
    
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCrKx21dIo3FUteB3MmHOjyizo3E_sK7Ec",
            authDomain: "check-6227f.firebaseapp.com",
            projectId: "check-6227f",
            storageBucket: "check-6227f.appspot.com",
            messagingSenderId: "911891676739",
            appId: "1:911891676739:web:94269f07802acc2cc71ef6"
        };

        firebase.initializeApp(firebaseConfig);
        let db = firebase.firestore();

        document.addEventListener('DOMContentLoaded', (event) => {
            loadData();
        });

        function getUserIdFromLocalStorage() {
            return JSON.parse(localStorage.getItem("user")).uid;
        }

        function escapeHTML(text) {
            return text.replace(/[&<>"']/g, function (match) {
                switch (match) {
                    case '&': return '&amp;';
                    case '<': return '&lt;';
                    case '>': return '&gt;';
                    case '"': return '&quot;';
                    case "'": return '&#39;';
                }
            });
        }

        function loadData() {
            const uid = getUserIdFromLocalStorage();
            if (!uid) return;
            db.collection("contact-list").where("userId", "==", uid).get().then((querySnapshot) => {
                const dataDiv = document.getElementById('data');
                dataDiv.innerHTML = '';
                querySnapshot.forEach((doc) => {
                    const div = document.createElement('div');
                    div.classList.add('message-container');
                    div.innerHTML = `
                    <div class="icon-buttons">
                        <button class="icon-button" onclick="populateUpdate('${doc.id}', '${escapeHTML(doc.data().message).replace(/\n/g, '\\n')}')">
                            <i class="fa-solid fa-pen-to-square"></i>
                        </button>
                        <button class="icon-button" onclick="deleteData('${doc.id}')">
                            <i class="fa-solid fa-trash"></i>
                        </button>
                        <button class="icon-button copy-btn">
                            <i class="fa-regular fa-copy"></i>
                        </button>
                        <i class="fa-solid fa-check-double copied-icon" style="display:none;"></i>
                    </div>
                    <p class="message-content">${escapeHTML(doc.data().message)}</p>
                `;
                    dataDiv.appendChild(div);

                    // Attach event listener to the newly created copy button
                    div.querySelector('.copy-btn').addEventListener('click', () => {
                        copyMessage(escapeHTML(doc.data().message), div.querySelector('.copied-icon'));
                    });
                });
            });
        }

        function send() {
            let message = document.getElementById('message');
            let messageId = document.getElementById('messageId');
            const uid = getUserIdFromLocalStorage();
            if (!uid) return;
            if (message.value !== '') {
                if (messageId.value === '') {
                    db.collection("contact-list").add({
                        message: message.value,
                        userId: uid
                    }).then(() => {
                        message.value = '';
                        loadData();
                    });
                } else {
                    db.collection("contact-list").doc(messageId.value).update({
                        message: message.value,
                        userId: uid
                    }).then(() => {
                        message.value = '';
                        messageId.value = '';
                        loadData();
                    });
                }
            }
        }

        function populateUpdate(id, currentMessage) {
            let message = document.getElementById('message');
            let messageId = document.getElementById('messageId');
            message.value = currentMessage;
            messageId.value = id;
        }

        function deleteData(id) {
            db.collection("contact-list").doc(id).delete().then(() => {
                loadData();
            });
        }
        function copyMessage(message, copiedIcon) {
            // Remove HTML encoding before copying
            const decodedMessage = message.replace(/&lt;/g, "<").replace(/&gt;/g, ">").replace(/&quot;/g, "\"").replace(/&amp;/g, "&").replace(/&#39;/g, "'");

            navigator.clipboard.writeText(decodedMessage).then(() => {
                console.log("Copied to clipboard:", decodedMessage);
                copiedIcon.style.display = 'inline'; // Show the double check icon
                setTimeout(() => {
                    copiedIcon.style.display = 'none'; // Hide the double check icon after 2 seconds
                }, 2000);
                const copyNotification = document.getElementById('copyNotification');
                copyNotification.style.display = 'block'; // Show the notification
                setTimeout(() => {
                    copyNotification.style.display = 'none'; // Hide the notification after 2 seconds
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy: ', err);
            });
        }
    </script>
    <!-- footer file included -->
    <div id="includefooter">
        <!-- importing js code -->

        <script>
            $("#includnav").load("/header&footer/nav.html");
            $("#includefooter").load("/header&footer/footer.html");
        </script>
        <!-- for dark mode and light mode -->
        <script>
            var darkicon = document.getElementById("darkicon");
            darkicon.onclick = function () {
                document.body.classList.toggle("dark_theme");
                if (document.body.classList.contains("dark_theme")) {
                    darkicon.innerHTML = '<i class="fa-solid fa-sun"></i>';
                }
                else {
                    darkicon.innerHTML = '<i class="fa-solid fa-moon"></i>';
                }
            }
        </script>
        <!-- for share the weblink -->
        <script>
            async function sharepage() {
                await navigator.share({
                    title: document.title,
                    url: window.location.href
                })
            }
        </script>
        <!-- logout section of js code  -->
        <script src="/header&footer/logout.js"> </script>
</body>

</html>