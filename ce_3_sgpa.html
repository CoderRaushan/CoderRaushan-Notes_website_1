<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="ce_3_sgpa.css">
    <title>CE Sem 3 Branch Sgpa Calculate</title>
</head>
<body>
    <html>
<head>
    <title class="hi">SGPA Calculator</title>
    <script id="yy">
        function calculateSGPA() 
        {
            var arr = [];
            var sub = ["Surveying & Geomatics","Solid Mechanics","Fluid Mechanics","DP&P","BEC","CE-ISGI","Survey-Lab","FM-Lab","SM-Lab","Training-1"];
            for (var n = 0; n <=9; n++) 
            {
                var inputId = "marks" + n;
                var marks = parseFloat(document.getElementById(inputId).value);
                if (isNaN(marks) || marks === "CRN") 
                {
                alert("Please fill in all sections before calculating SGPA.");
                return; 
                }
                arr.push(marks);
            }
            var crn = document.getElementById("CRN").value;
            if (crn.length !==7) 
            {
            alert("Please enter the valid CRN before calculating SGPA.");
            return;
            }
            if (crn.substring(0, 4) !== "2214") 
            {
            alert("Please enter the valid CRN before calculating SGPA.");
            return; 
            }
            var o = (arr[0] / 100) * 100;
            var o1 = (arr[1] / 100) * 100;
            var o2 = (arr[2] / 100) * 100;
            var o3 = (arr[3] / 100) * 100;
            var o4 = (arr[4] / 100) * 100;
            var o5 = (arr[5] / 100) * 100;
            var o6 = (arr[6] / 50) * 100;
            var o7 = (arr[7] / 50) * 100;
            var o8 = (arr[8] / 50 )* 100;
            var o9 = (arr[9] / 100) * 100;
          

            var p = Math.floor(o / 10) + 1;
            var p1 = Math.floor(o1 / 10) + 1;
            var p2 = Math.floor(o2 / 10) + 1;
            var p3 = Math.floor(o3 / 10) + 1;
            var p4 = Math.floor(o4 / 10) + 1;
            var p5 = Math.floor(o5 / 10) + 1;
            var p6 = Math.floor(o6 / 10) + 1;
            var p7 = Math.floor(o7 / 10) + 1;
            var p8 = Math.floor(o8 / 10) + 1;
            var p9 = Math.floor(o9 / 10) + 1;
           

            var res = p * 4;
            var res1 = p1 * 3;
            var res2 = p2 * 3;
            var res3 = p3 * 3;
            var res4 = p4 * 3;
            var res5 = p5 * 3;
            var res6 = p6 * 1;
            var res7 = p7 * 1;
            var res8 = p8 * 1;
            var res9 = p9 * 1;
           

            var c1 = 23;
            var dum = res + res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9;
            var sgpa = dum / c1;

            document.getElementById("sgpaResult").innerHTML = "SGPA: " + sgpa.toFixed(2);
        }
    </script>
</head>
<body>
   <div>  
   
    <h1 id="yy"> <img   class="logo"src="logo.png" alt=""><diB  class="name" >CE 3rd Semester SGPA Calculator</helo></h1>
        <a  class="home" href="index.html" target="_blank">Home page</a>
        <a  class="home1" href="nested_cal.html" target="_blank">Previous page </a>
   
   </div>
    <form method="post" name="submit-to-google-sheet"> <br>
        <table>
            <tr>
                <td><label for="marks0">Survey  & <br> Geomatics:</label></td>
                <td><input type="number" id="marks0" placeholder="Enter internel + external" name="S&G"></td>
            </tr>
            <tr>
                <td><label for="marks1">SM:</label></td>
                <td><input type="number" id="marks1" placeholder="Enter internel + external" name="SM"></td>
            </tr>
            <tr>
                <td><label for="marks2">FM:</label></td>
                <td><input type="number" id="marks2" placeholder="Enter internel + external" name="FM"></td>
            </tr>
            <tr>
                <td><label for="marks3">DP&P:</label></td>
                <td><input type="number" id="marks3" placeholder="Enter internel + external" name="DP&P"></td>
            </tr>
            <tr>
                <td><label for="marks4">BEC:</label></td>
                <td><input type="number" id="marks4" placeholder="Enter internel + external" name="BEC"></td>
            </tr>
            <tr>
                <td><label for="marks5">CE-ISGI:</label></td>
                <td><input type="number" id="marks5" placeholder="Enter internel + external" name="CE-ISGI"></td>
            </tr>
            <tr>
                <td><label for="marks6">Survey-Lab:</label></td>
                <td><input type="number" id="marks6" placeholder="Enter internel + external" name="Survey-Lab"></td>
            </tr>
            <tr>
                <td><label for="marks7">FM-Lab:</label></td>
                <td><input type="number" id="marks7" placeholder="Enter internel + external" name="FM-Lab"></td>
            </tr>
            <tr>
                <td><label for="marks8">SM-Lab:</label></td>
                <td><input type="number" id="marks8" placeholder="Enter internel + external" name="SM-Lab"></td>
            </tr>
            <tr>
                <td><label for="marks9">Tranning-1:</label></td>
                <td><input type="number" id="marks9" placeholder="Enter internel + external" name="Tranning-1"></td>
            </tr>
            <tr>
                <td><label for="CRN">CRN:</label></td>
                <td><input type="number" id="CRN"  placeholder="Enter CRN" name="CRN"></td>
            </tr>
            <tr>
                <input type="hidden" id="sgpaInput" name="SGPA" value="">
                <button id="noshow" type="submit" name="submit" onclick="calculateSGPA()">Calculate SGPA</button>
            </tr>
           
        </table>
        <button type="submit" name="submit" onclick="calculateSGPA()">Calculate SGPA</button>
    </form>
    <p id="sgpaResult"></p>
     
    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbwSTkEFjV3OqDUfaKovJWZoRvRTbNSCb8Zd6-4Y7y4-VajN7U5YS0sqPbRpUd6K8IfW/exec'
        const form = document.forms['submit-to-google-sheet']
      
        form.addEventListener('submit', e => {
          e.preventDefault();
          const sgpaValue = document.getElementById("sgpaInput").value;
          const formData = new FormData(form);
        formData.append('SGPA', sgpaValue);
          fetch(scriptURL, { method: 'POST', body: new FormData(form)})
            .then(response => console.log('Success!', response))
            .catch(error => console.error('Error!', error.message))
        });
      </script>
</body>
<footer class="foter">
    <div class="auto"> 
        
        <script type="text/javascript" src="https://www.counters-free.net/count/di0e"></script><br>
        <a href='http://www.freevisitorcounters.com'>.</a> <script type='text/javascript' src='https://whomania.com/ctr?id=87b29ffbb633494216a9b14c5748549873533df5'></script>
 
    </div>
</footer>
</html>

</body>
</html>